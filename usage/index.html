<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Lionel GUEZ">
  <link rel="canonical" href="https://www.lmd.jussieu.fr/~lguez/Max_diff_nc_site/index.html/usage/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Usage - Max_diff_nc documentation</title>
  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Usage";
    var mkdocs_page_input_path = "usage.md";
    var mkdocs_page_url = "/~lguez/Max_diff_nc_site/index.html/usage/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Max_diff_nc documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">Home</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">What is it?</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../other_utils/">Alternatives</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Usage</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Usage</a>
    <ul class="current">
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../example_1/">Example run without -m</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../example_2/">Example run with -m</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Notes</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../French_centers/">Note for the users of French supercomputing centers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../main_memory/">Main memory used</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../changes/">Changes before version control</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../bug_gfortran/">Known bug of old Gfortran</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Max_diff_nc documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Usage &raquo;</li>
        
      
    
    <li>Usage</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/lguez/Max_diff_nc/edit/master/docs/usage.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="usage">Usage</h1>
<p>If you run <code>max_diff_nc.sh</code> with argument <code>-h</code>, you will get a short
usage message:</p>
<pre><code>$ max_diff_nc.sh -h
Usage: max_diff_nc.sh [OPTION]... file file-or-directory

Compute and locate difference between NetCDF files.

Options:
   -h: this help message
   -s: report identical variables
   -m: compute average order of magnitude
   -i: compare variables with same varid, regardless of variable name
   -q: only report names of variables which differ, without maximum difference
   -v &lt;var&gt;: only compare variable with name &lt;var&gt;
</code></pre>
<p><code>max_diff_nc.sh</code> requires two arguments: the files to compare. If the
second argument is a directory then <code>max_diff_nc.sh</code> will look in this
directory for a file with the same basename as the first argument. The
order of the files is important. The first file is taken as the
reference file in order to compute relative differences. If you
permute the files, the absolute differences will not change but, in
general, the relative differences will change.</p>
<p>Consider a particular variable name (or variable ID, for option <code>-i</code>).
The program reads one array of values from each input file,
corresponding to that variable name (or variable ID, for option <code>-i</code>).
Let us call <code>data_old</code> the array from the first input file and
<code>data_new</code> the array from the second input file. We assume the arrays
have the same shape (the program will stop if they do not). The program
computes the &ldquo;absolute difference&rdquo;:</p>
<p>
<script type="math/tex; mode=display">|\mathrm{data\_old} - \mathrm{data\_new}|</script>
</p>
<p>and the &ldquo;relative difference&rdquo;:</p>
<p>
<script type="math/tex; mode=display">\left|\frac{\mathrm{data\_old} - \mathrm{data\_new}}{\mathrm{data\_old}} \right|</script>
</p>
<p>The program takes special care of zero values. We construct a mask that
tells us, for each position (set of indices in each dimension), whether
there is a zero value at that position in either array. That is, in the
Fortran program, we define the logical array <code>zero</code>:</p>
<pre><code>zero = data_old == 0. .or. data_new == 0
</code></pre>
<p>The program only computes the relative difference where <code>zero</code> is false.
For the absolute difference, the program gives two results: a global
result, for the whole arrays, and a result for the portions of the
arrays where <code>zero</code> is true.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../example_1/" class="btn btn-neutral float-right" title="Example run without -m">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../installation/" class="btn btn-neutral" title="Installation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/lguez/Max_diff_nc/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../installation/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../example_1/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
